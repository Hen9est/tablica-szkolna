<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zegar i Szczęśliwy Numer</title>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
    
    <style>
        /* Domyślne zmienne CSS dla kolorów - zostaną nadpisane przez JS */
        :root {
            --theme-title-color: #a8dadc;
            --theme-number-color: #f1faee;
            --theme-bg-gradient-start: #000020;
            --theme-bg-gradient-end: #4a0d66;
            --theme-border-color: black;
            --theme-star-color: white;
        }

        body {
            margin: 0;
            overflow: hidden; /* Ukrywa zawartość wychodzącą poza ustalone wymiary */
            background-color: #f0f0f0; /* Jasne tło strony */
            display: flex; /* Użycie flexbox do centrowania głównego kontenera */
            justify-content: center;
            align-items: center; /* Centrowanie w pionie całego #main-wrapper */
            font-family: 'Roboto', sans-serif; /* Domyślna czcionka dla reszty */
            color: #333;
            height: 100vh; /* Pełna wysokość viewport */
        }

        #main-wrapper {
            width: 640px; /* Całkowita szerokość strony */
            height: 280px; /* Zmieniona wysokość na 280px */
            display: flex; /* Użycie flexbox do ułożenia paneli obok siebie */
            flex-direction: row; /* Panele ułożone w rzędzie (obok siebie) */
            box-shadow: 0 0 10px rgba(0,0,0,0.1); /* Lekki cień, aby wizualnie oddzielić stronę */
            background-color: #fff; /* Białe tło dla wrapper'a */
        }

        .panel {
            flex: 1; /* Każdy panel zajmuje równą część dostępnej przestrzeni */
            display: flex;
            flex-direction: column; /* Ułożenie elementów w kolumnie w panelu */
            justify-content: flex-start; /* Wyrównanie zawartości do góry */
            padding: 10px;
            box-sizing: border-box; /* Padding wliczony w szerokość/wysokość */
            align-items: center; /* Domyślne centrowanie w poziomie dla zawartości panelu */
        }

        #left-panel {
            background-color: #f9f9f9; /* Lekko ciemniejsze tło dla lewego panelu */
            border-right: 1px solid #eee; /* Delikatna linia oddzielająca panele */
            padding-top: 25px; /* Dodatkowy padding od góry, aby przesunąć zawartość o 25px */
        }

        #right-panel {
            background-color: #ffffff; /* Białe tło dla prawego panelu */
            padding-top: 25px; /* Dodatkowy padding od góry, aby przesunąć zawartość o 25px */
        }

        /* Spacer na dole panelu */
        .bottom-spacer {
            height: 50px; /* Wysokość wolnej przestrzeni na dole */
            width: 100%; /* Rozciąga się na całą szerokość panelu */
        }

        /* Style dla zegara */
        #clock-container {
            display: flex; /* Użycie Flexbox */
            flex-direction: column; /* Ułożenie elementów w kolumnie */
            justify-content: center; 
            align-items: center; /* Wyśrodkowanie elementów w poziomie */
            width: 100%; /* Kontener zegara wypełnia dostępną szerokość panelu */
            text-align: center; /* Wyrównanie tekstu do środka */
            height: auto; /* Wysokość auto, aby dopasować do zawartości */
            flex-grow: 1; /* Pozwala zegarowi zająć dostępną przestrzeń powyżej spacera */
        }

        #dayofweek { /* Dzień tygodnia (najwyżej) */
            font-family: 'Roboto', sans-serif; /* Zmieniona czcionka na Roboto */
            font-size: 0.9em; /* Mały rozmiar czcionki */
            font-weight: 400;
            color: #616161;
            letter-spacing: 0.05em; /* Lekkie rozciągnięcie liter */
            text-transform: uppercase; /* Wszystkie litery wielkie, jak w niektórych widżetach */
            line-height: 1.2;
            margin-bottom: 2px; /* Mały odstęp od daty */
        }
        #current-date { /* Data (środkowa pozycja) */
            font-size: 1.1em; /* Mały rozmiar czcionki */
            font-weight: 400;
            color: #424242;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
            line-height: 1.2;
            white-space: nowrap;
            margin-bottom: 5px; /* Odstęp od godziny */
        }
        #current-time { /* Godzina (najniżej i największa) */
            font-size: 2.5em; /* Zmniejszony rozmiar czcionki dla godziny, aby zmieściła się i była wyśrodkowana */
            font-weight: 300;
            color: #212121;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.08);
            line-height: 1.2;
            white-space: nowrap;
        }

        /* Style dla Szczęśliwego Numeru */
        #lucky-number-container {
            width: 90%; /* Dostosowanie szerokości do panelu */
            height: auto; /* Pozwala na dopasowanie wysokości do zawartości */
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 8px solid var(--theme-border-color); /* Użycie zmiennej CSS */
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            overflow: hidden;
            padding: 5px; /* Zmniejszony padding */
            box-sizing: border-box;
            background: linear-gradient(135deg, var(--theme-bg-gradient-start) 0%, var(--theme-bg-gradient-end) 100%); /* Użycie zmiennych CSS */
            color: var(--theme-number-color); /* Domyślny kolor tekstu */
            flex-grow: 1; /* Pozwala kontenerowi zająć dostępną przestrzeń powyżej spacera */
            max-height: calc(100% - 25px - 50px - 20px); /* Maksymalna wysokość = wysokość panelu - padding-top - spacer - padding wewnętrzny */
        }

        #lucky-number-container .title {
            font-family: 'Bangers', cursive; /* Specyficzna czcionka */
            font-size: 1.8em; /* Zmniejszony rozmiar czcionki */
            line-height: 1.1;
            margin: 0 0 2px 0; /* Mniejszy margines */
            -webkit-text-stroke: 1.5px black; /* Zmniejszona grubość obrysu */
            text-stroke: 1.5px black;
            z-index: 10;
            text-align: center;
            color: var(--theme-title-color); /* Użycie zmiennej CSS */
        }

        #lucky-number-container .lucky-number-display {
            font-family: 'Bangers', cursive; /* Specyficzna czcionka */
            font-size: 5em; /* Zmniejszony rozmiar czcionki */
            line-height: 1;
            margin: 0;
            padding: 0;
            -webkit-text-stroke: 3px black; /* Zmniejszona grubość obrysu */
            text-stroke: 3px black;
            text-shadow: 5px 5px 0px rgba(0,0,0,0.25); /* Zmniejszony cień */
            z-index: 10;
            animation: pulse 2s infinite ease-in-out;
            text-align: center;
            color: var(--theme-number-color); /* Użycie zmiennej CSS */
            transition: all 0.3s ease-out; /* Płynne przejście dla transformacji */
        }

        /* Styl dla cyfry 7 */
        #lucky-number-container .lucky-number-display.is-seven {
            transform: scale(1.05) rotate(1deg); /* Lekko większa i obrócona */
            text-shadow: 6px 6px 0px rgba(0, 255, 255, 0.3), 10px 10px 0px rgba(0,0,0,0.25); /* Dodatkowy cień w kolorze cyjanu */
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Gwiazdki w tle */
        #lucky-number-container::before {
            content: '';
            position: absolute;
            z-index: 1;
            width: 2px; height: 2px; background: var(--theme-star-color); /* Użycie zmiennej CSS */
            border-radius: 50%;
            /* Dostosowane pozycje gwiazdek do mniejszego kontenera */
            box-shadow: 80px -20px 2px var(--theme-star-color), -50px 60px 1.5px var(--theme-star-color), 100px 100px 3px var(--theme-star-color), -100px -100px 1.5px var(--theme-star-color), 20px 20px 1.5px var(--theme-star-color), -40px 80px 2.5px var(--theme-star-color), 60px -40px 1.5px var(--theme-star-color);
            animation: twinkle 3s infinite;
        }
        @keyframes twinkle { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

    </style>
</head>
<body>

    <div id="main-wrapper">
        <div id="left-panel" class="panel">
            <div id="clock-container">
                <div id="dayofweek"></div>
                <div id="current-date"></div>
                <div id="current-time"></div>
            </div>
            <div class="bottom-spacer"></div> </div>

        <div id="right-panel" class="panel">
            <div id="lucky-number-container">
                <h2 class="title">Szczęśliwy Numer</h2>
                <h1 id="lucky-number-display" class="lucky-number-display">8</h1>
            </div>
            <div class="bottom-spacer"></div> </div>
    </div>

    <script>
        // Funkcja do formatowania samej godziny
        function formatTime(date) {
            const hour = date.getHours().toString().padStart(2, '0');
            const minute = date.getMinutes().toString().padStart(2, '0');
            const second = date.getSeconds().toString().padStart(2, '0');
            return `${hour}:${minute}:${second}`;
        }

        // Funkcja do formatowania samej daty (dzień, miesiąc, rok)
        function formatDate(date) {
            const options = {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            };
            return date.toLocaleDateString('pl-PL', options);
        }

        // Funkcja do formatowania nazwy dnia tygodnia
        function formatDayOfWeek(date) {
            const options = {
                weekday: 'long' // Wyświetla pełną nazwę dnia tygodnia (np. poniedziałek)
            };
            return date.toLocaleDateString('pl-PL', options);
        }

        // Funkcja aktualizująca zawartość wszystkich elementów zegara
        function updateDateTime() {
            const now = new Date();
            const currentTimeElement = document.getElementById('current-time');
            const currentDateElement = document.getElementById('current-date');
            const dayOfWeekElement = document.getElementById('dayofweek');
            
            if (currentTimeElement && currentDateElement && dayOfWeekElement) {
                currentTimeElement.textContent = formatTime(now);
                currentDateElement.textContent = formatDate(now);
                dayOfWeekElement.textContent = formatDayOfWeek(now);
            }
        }

        // Definicje motywów komiksowych
        const comicThemes = [
            {
                name: "Space Purple",
                titleColor: "#a8dadc", // Comic Light Blue
                numberColor: "#f1faee", // Comic White
                bgGradientStart: "#000020", // Space Dark
                bgGradientEnd: "#4a0d66", // Space Purple
                borderColor: "black",
                starColor: "white"
            },
            {
                name: "Vibrant Pop Art",
                titleColor: "#ff007f", // Hot Pink
                numberColor: "#ffff00", // Bright Yellow
                bgGradientStart: "#00bfff", // Deep Sky Blue
                bgGradientEnd: "#ff4500", // Orange Red
                borderColor: "black",
                starColor: "white"
            },
            {
                name: "Grungy Dark Comic",
                titleColor: "#9acd32", // Yellow Green
                numberColor: "#dcdcdc", // Light Gray
                bgGradientStart: "#36454f", // Charcoal
                bgGradientEnd: "#1a1a1a", // Dark Gray
                borderColor: "white",
                starColor: "#ffcc00" // Gold
            },
            {
                name: "Classic Comic Blue",
                titleColor: "#dc143c", // Crimson
                numberColor: "#ffffff", // White
                bgGradientStart: "#4169e1", // Royal Blue
                bgGradientEnd: "#8a2be2", // Blue Violet
                borderColor: "black",
                starColor: "#ffff00" // Yellow
            }
        ];

        // Stała dla zakresu liczb szczęśliwych
        const LUCKY_NUMBER_MAX = 18;

        // Funkcja do tasowania tablicy (algorytm Fishera-Yatesa)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Zamiana elementów
            }
            return array;
        }

        /**
         * Pobiera wartość dla bieżącego dnia z localStorage lub generuje nową.
         * Dla szczęśliwego numeru zarządza pulą numerów (losowanie bez powtórzeń).
         * @param {string} keyPrefix Prefiks klucza w localStorage (np. 'luckyNumber_').
         * @param {function} generateValueFn Funkcja generująca nową wartość (dla motywów).
         * @returns {any} Wartość dla bieżącego dnia.
         */
        function getDailyValue(keyPrefix, generateValueFn) {
            const today = new Date().toDateString(); // Format 'Mon Jul 14 2025'
            const storedDate = localStorage.getItem(keyPrefix + 'date');
            let storedValue = localStorage.getItem(keyPrefix + 'value');

            if (storedDate === today && storedValue !== null) {
                // Jeśli data się zgadza i wartość istnieje, zwróć ją
                return JSON.parse(storedValue);
            } else {
                // Jeśli nowa data lub brak wartości, wygeneruj nową i zapisz
                const newValue = generateValueFn();
                localStorage.setItem(keyPrefix + 'date', today);
                localStorage.setItem(keyPrefix + 'value', JSON.stringify(newValue));
                return newValue;
            }
        }

        // Funkcja do pobierania dziennego szczęśliwego numeru z puli (bez powtórzeń)
        function getDailyLuckyNumberFromPool() {
            const today = new Date().toDateString();
            
            let storedLuckyNumberDate = localStorage.getItem('luckyNumber_date');
            let storedLuckyNumberValue = localStorage.getItem('luckyNumber_value');
            let storedNumbersPool = JSON.parse(localStorage.getItem('luckyNumbersPool_'));

            // Sprawdź, czy mamy zapisaną wartość dla dzisiaj
            if (storedLuckyNumberDate === today && storedLuckyNumberValue !== null) {
                return JSON.parse(storedLuckyNumberValue); // Jeśli tak, zwróć ją
            } 
            // Jeśli nowy dzień lub brak zapisanej wartości dla dzisiaj
            else {
                let currentPool = storedNumbersPool;

                // Jeśli pula jest pusta lub nie istnieje, stwórz nową i ją potasuj
                if (!currentPool || currentPool.length === 0) {
                    currentPool = [];
                    for (let i = 1; i <= LUCKY_NUMBER_MAX; i++) {
                        currentPool.push(i);
                    }
                    currentPool = shuffleArray(currentPool);
                    console.log("Utworzono i potasowano nową pulę szczęśliwych numerów:", currentPool);
                }

                const drawnNumber = currentPool.shift(); // Pobierz pierwszy numer z puli
                
                // Zapisz wylosowany numer, aktualną pulę i datę
                localStorage.setItem('luckyNumber_date', today);
                localStorage.setItem('luckyNumber_value', JSON.stringify(drawnNumber));
                localStorage.setItem('luckyNumbersPool_', JSON.stringify(currentPool)); 

                console.log(`Wylosowano numer: ${drawnNumber}, Pozostałe w puli:`, currentPool);
                return drawnNumber;
            }
        }

        // Funkcja generująca losowy motyw
        function generateRandomTheme() {
            const randomIndex = Math.floor(Math.random() * comicThemes.length);
            return comicThemes[randomIndex];
        }

        // Funkcja aktualizująca szczęśliwy numer i motyw
        function updateLuckyNumberAndTheme() {
            const luckyNumberElement = document.getElementById('lucky-number-display');
            const root = document.documentElement; // Element :root

            // Pobierz dzienny szczęśliwy numer (z puli bez powtórzeń)
            const currentLuckyNumber = getDailyLuckyNumberFromPool();
            if (luckyNumberElement) {
                luckyNumberElement.textContent = currentLuckyNumber;
                
                // Dodaj/usuń klasę 'is-seven' w zależności od numeru
                if (currentLuckyNumber === 7) {
                    luckyNumberElement.classList.add('is-seven');
                } else {
                    luckyNumberElement.classList.remove('is-seven');
                }
            }

            // Pobierz dzienny motyw (losowy)
            const currentTheme = getDailyValue('luckyTheme_', generateRandomTheme);
            if (currentTheme) {
                // Zastosuj zmienne CSS dla wybranego motywu
                root.style.setProperty('--theme-title-color', currentTheme.titleColor);
                root.style.setProperty('--theme-number-color', currentTheme.numberColor);
                root.style.setProperty('--theme-bg-gradient-start', currentTheme.bgGradientStart);
                root.style.setProperty('--theme-bg-gradient-end', currentTheme.bgGradientEnd);
                root.style.setProperty('--theme-border-color', currentTheme.borderColor);
                root.style.setProperty('--theme-star-color', currentTheme.starColor);
            }
            
            // Po aktualizacji, zaplanuj kolejną na następną północ
            scheduleDailyUpdate();
        }

        // Funkcja planująca aktualizację na następną północ
        function scheduleDailyUpdate() {
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(now.getDate() + 1);
            tomorrow.setHours(0, 0, 0, 0); // Ustaw na północ następnego dnia

            const timeUntilMidnight = tomorrow.getTime() - now.getTime();
            
            // Ustaw timer, który wywoła updateLuckyNumberAndTheme o północy
            setTimeout(updateLuckyNumberAndTheme, timeUntilMidnight);
            console.log(`Następna aktualizacja numeru/motywu zaplanowana za ${timeUntilMidnight / 1000 / 60} minut.`);
        }

        // Wywołaj funkcje od razu po załadowaniu strony
        updateDateTime();
        updateLuckyNumberAndTheme(); // Wywołaj funkcję dla szczęśliwego numeru i motywu

        // Ustaw interwał, aby aktualizować wszystkie elementy zegara co sekundę
        setInterval(updateDateTime, 1000);

        // Funkcja scheduleDailyUpdate() jest wywoływana w updateLuckyNumberAndTheme(),
        // więc nie ma potrzeby wywoływania jej osobno tutaj.
    </script>

</body>
</html>
